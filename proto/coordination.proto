syntax = "proto3";

option go_package = "github.com/streamnative/oxia";

package oxia;

import "google/protobuf/empty.proto";

service OxiaCoordination {
  //controller -> node
  rpc Fence(FenceRequest) returns (FenceResponse) {}
  //controller -> node (non-leader)
  rpc BecomeLeader(BecomeLeaderRequest) returns (BecomeLeaderResponse) {}
  //controller -> node (leader)
  rpc AddFollower(AddFollowerRequest) returns (google.protobuf.Empty) {}
  //node (leader) -> node (follower)
  rpc Truncate(TruncateRequest) returns (TruncateResponse) {}
  //node (leader) -> node (follower)
  rpc AddEntry(AddEntryRequest) returns (AddEntryResponse) {}
  //controller -> node (leader)
  rpc PrepareReconfig(PrepareReconfigRequest) returns (PrepareReconfigResponse) {}
  //controller -> node (new follower)
  rpc Snapshot(SnapshotRequest) returns (SnapshotResponse) {}
  //controller -> node (leader)
  rpc CommitReconfig(CommitReconfigRequest) returns (CommitReconfigResponse) {}
}


message FenceRequest {}
message FenceResponse {}

message BecomeLeaderRequest {}
message BecomeLeaderResponse {}

message AddFollowerRequest {}
message AddFollowerResponse {}

message TruncateRequest {}
message TruncateResponse {}

message AddEntryRequest {}
message AddEntryResponse {}

message PrepareReconfigRequest {}
message PrepareReconfigResponse {}

message SnapshotRequest {}
message SnapshotResponse {}

message CommitReconfigRequest {}
message CommitReconfigResponse {}
